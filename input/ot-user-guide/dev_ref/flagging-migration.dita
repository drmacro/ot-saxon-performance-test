<?xml version="1.0" encoding="utf-8"?><?workdir /Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/temp/xhtml/dev_ref?><?workdir-uri file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/temp/xhtml/dev_ref/?><?path2project ../?><?path2project-uri ../?><?doctype-public -//OASIS//DTD DITA Reference//EN?><?doctype-system reference.dtd?><reference xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/" xmlns:dita-ot="http://dita-ot.sourceforge.net/ns/201007/dita-ot" id="flagging-migration" rev="1.7" xml:lang="en-US" ditaarch:DITAArchVersion="1.3" domains="(topic reference)                            (topic abbrev-d)                            a(props deliveryTarget)                            (topic equation-d)                            (topic hazard-d)                            (topic hi-d)                            (topic indexing-d)                            (topic markup-d)                            (topic mathml-d)                            (topic pr-d)                            (topic relmgmt-d)                            (topic sw-d)                            (topic svg-d)                            (topic ui-d)                            (topic ut-d)                            (topic markup-d xml-d)   " class="- topic/topic       reference/reference " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="reference:1;5:63">
  <title class="- topic/title " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="title:1;6:10">XHTML migration for flagging updates in DITA-OT 1.7</title>
  <shortdesc class="- topic/shortdesc " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="shortdesc:1;7:14">This topic is primarily of interest to developers with XHTML transform overrides written prior to DITA-OT
    1.7. Due to significant changes in the flagging process with the 1.7 release, some changes may be needed to make
    overrides work properly with DITAVAL based flagging. The new design is significantly simpler than the old design; in
    many cases, migration will consist of deleting old code that is no longer needed.</shortdesc>
  <refbody class="- topic/body        reference/refbody " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="refbody:1;11:12">
    <section class="- topic/section " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="section:1;12:14">
      <title class="- topic/title " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="title:2;13:14">Which XHTML overrides need to migrate?</title>
      <p class="- topic/p " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="p:1;14:10">If your override does not contain any code related to DITAVAL flagging, then there is nothing to migrate.</p>
      <p class="- topic/p " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="p:2;15:10">If your builds do not make use of DITAVAL based flagging, but calls the deprecated flagging templates, then you
        should override but there is little urgency. You will not see any difference in the output, but those templates
        will be removed in a future release.</p>
      <p class="- topic/p " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="p:3;18:10">If you do make use of DITAVAL based flagging, try using your override with 1.7. Check the elements you override:<ol class="- topic/ol " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="ol:1;18:126">
          <li class="- topic/li " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="li:1;19:15">In some cases flags may be doubled. This will be the case if you call routines such as
              <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:1;20:23">"start-flagit"</codeph>.</li>
          <li class="- topic/li " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="li:2;21:15">In some cases flags may be removed. This will be the case if you call shortcut routines such as
              <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:2;22:23">"revtext"</codeph> or <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:3;22:53">"revblock"</codeph>.</li>
          <li class="- topic/li " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="li:3;23:15">In other cases, flags may still appear properly, in which case migration is less urgent</li>
        </ol></p>
      <p class="- topic/p " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="p:4;25:10">For any migration that needs migration, please see the instructions that follow.</p></section>
    <section class="- topic/section " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="section:2;26:14">
      <title class="- topic/title " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="title:3;27:14">Deprecated templates in DITA-OT 1.7</title>
      <p class="- topic/p " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="p:5;28:10">All of the old DITAVAL based templates are deprecated in DITA-OT 1.7. If your overrides include any of the
        following templates, they should be migrated for the new release; in many cases the templates below will not
        have any effect on your output, but all instances should be migrated.</p><ul class="- topic/ul " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="ul:1;30:86">
        <li class="- topic/li " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="li:4;31:13">The <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:4;31:25">"gen-style"</codeph> template used to add CSS styling</li>
        <li class="- topic/li " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="li:5;32:13">The <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:5;32:25">"start-flagit"</codeph> and <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:6;32:61">"end-flagit"</codeph> templates used to generate image flags
          based on property attributes like @audience</li>
        <li class="- topic/li " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="li:6;34:13">The <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:7;34:25">"start-revflag"</codeph> and <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:8;34:62">"end-revflag"</codeph> templates, used to generate images
          for active revisions</li>
        <li class="- topic/li " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="li:7;36:13">Shortcut templates that group these templates into a single call, such as:<ul class="- topic/ul " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="ul:2;36:91">
            <li class="- topic/li " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="li:8;37:17"><codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:9;37:25">"start-flags-and-rev"</codeph> and <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:10;37:68">"end-flags-and-rev"</codeph>, used to combine flags
              and revisions into one call</li>
            <li class="- topic/li " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="li:9;39:17"><codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:11;39:25">"revblock"</codeph> and <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:12;39:57">"revtext"</codeph>, both used to output start revisions, element
              content, and end revisions</li>
            <li class="- topic/li " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="li:10;41:17">The modes <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:13;41:35">"outputContentsWithFlags"</codeph> and
                <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:14;42:25">"outputContentsWithFlagsAndStyle"</codeph>, both used to combine processing for
              property/revision flags with content processing</li>
          </ul></li>
        <li class="- topic/li " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="li:11;45:13">All other templates that make use of the <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:15;45:62">$flagrules</codeph> variable, which is no longer used in
          any of the DITA-OT 1.7 code</li>
        <li class="- topic/li " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="li:12;47:13">All templates within <filepath class="+ topic/ph sw-d/filepath " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="filepath:1;47:44">flag.xsl</filepath> that were called from the templates listed above</li>
        <li class="- topic/li " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="li:13;48:13">Element processing handled with mode="elementname-fmt", such as <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:16;48:85">mode="ul-fmt"</codeph> for
          processing unordered lists and <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:17;49:50">mode="section-fmt"</codeph> for sections.</li>
      </ul></section>
    <section class="- topic/section " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="section:3;51:14">
      <title class="- topic/title " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="title:4;52:14">What replaces the templates?</title>
      <p class="- topic/p " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="p:6;53:10">The new flagging design described in the preprocess design section now adds literal copies of relevant DITAVAL
        elements, along with CSS based flagging information, into the relevant section of the topic. This allows most
        flags to be processed in document order; in addition, there is never a need to read the DITAVAL, interpret CSS,
        or evaluate flagging logic. The <filepath class="+ topic/ph sw-d/filepath " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="filepath:2;56:51">htmlflag.xsl</filepath> file contains a few rules to match and process
        the start/end flags; in most cases, all code to explicitly process flags can be deleted.</p>
      <p class="- topic/p " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="p:7;58:10">For example, the common logic for most element rules before DITA-OT 1.7 could be boiled down to the
        following:<lines xml:space="preserve" class="- topic/lines " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="lines:1;59:26">Match element
    Create <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:18;60:20">"flagrules"</codeph> variable by reading DITAVAL for active flags
    Output start tag such as <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:19;61:38">&lt;div&gt;</codeph> or <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:20;61:67">&lt;span&gt;</codeph>
        Call <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:21;62:22">"commonattributes"</codeph> and ID processing
        Call <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:22;63:22">"gen-style"</codeph> with <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:23;63:56">$flagrules</codeph>, to create DITAVAL based CSS
        Call <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:24;64:22">"start-flagit"</codeph> with <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:25;64:59">$flagrules</codeph>, to create start flag images
        Call <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:26;65:22">"start-revflag"</codeph> with <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:27;65:60">$flagrules</codeph>, to create start revision images
        Output contents
        Call <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:28;67:22">"end-revflag"</codeph> with <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:29;67:58">$flagrules</codeph>, to create end revision images
        Call <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:30;68:22">"end-flagit"</codeph> with <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:31;68:57">$flagrules</codeph>, to create end flag images
    Output end tag such as <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:32;69:36">&lt;/div&gt;</codeph> or <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:33;69:66">&lt;/span&gt;</codeph></lines></p>
      <p class="- topic/p " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="p:8;70:10">In DITA-OT 1.7, style and images are typically handled with XSLT fallthrough processing. This removes virtually
        all special flag coding from element rules, because flags are already part of the document and processed in
        document order. The sample above is reduced
        to:<lines xml:space="preserve" class="- topic/lines " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="lines:2;73:19">Match element
   Output start tag such as <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:34;74:37">&lt;div&gt;</codeph> or <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:35;74:66">&lt;span&gt;</codeph>
      Call <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:36;75:20">"commonattributes"</codeph> and ID processing
      Output contents
   Output end tag such as <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:37;77:35">&lt;/div&gt;</codeph> or <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:38;77:65">&lt;/span&gt;</codeph></lines></p></section>
    <section class="- topic/section " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="section:4;78:14">
      <title class="- topic/title " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="title:5;79:14">Migrating <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:39;79:32">"gen-style"</codeph> named template</title>
      <p class="- topic/p " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="p:9;80:10">Calls to the <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:40;80:31">"gen-style"</codeph> template should be deleted. There is no need to replace this call for
        most elements.</p>
      <p class="- topic/p " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="p:10;82:10">The <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:41;82:22">"gen-style"</codeph> template was designed to read a DITAVAL file, find active style-based flagging
        (such as colored or bold text), and add it to the generated @style attribute in HTML.</p>
      <p class="- topic/p " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="p:11;84:10">With DITA-OT 1.7, the style is calculated in the pre-process flagging module. The result is created as
        @outputclass on a <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:42;85:35">&lt;ditaval-startprop&gt;</codeph> sub-element. The <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:43;85:92">"commonattributes"</codeph>
        template now includes a line to process that value; the result is that for every element that calls
          <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:44;87:19">"commonattributes"</codeph>, DITAVAL style will be processed when needed. Because virtually every
        element includes a call to this common template, there is little chance that your override needs to explicitly
        process the style. The new line in <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:45;89:52">"commonattributes"</codeph> that handles the style is:
        <codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeblock:1;90:20">&lt;xsl:apply-templates select="*[contains(@class,' ditaot-d/ditaval-startprop ')]/@outputclass" mode="add-ditaval-style"/&gt;</codeblock></p></section>
    <section class="- topic/section " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="section:5;91:14">
      <title class="- topic/title " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="title:6;92:14">Migrating <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:46;92:32">"start-flagit"</codeph>, <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:47;92:65">"start-revflag"</codeph>, <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:48;92:99">"end-flagit"</codeph>,
        and <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:49;93:21">"end-flagit"</codeph> named templates</title>
      <p class="- topic/p " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="p:12;94:10">Calls to these templates fall into two general groups.</p>
      <p class="- topic/p " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="p:13;95:10">If the flow of your element rule is to create a start tag like <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:50;95:81">&lt;div&gt;</codeph>,
          <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:51;96:19">"start-flagit"</codeph>/<codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:52;96:51">"start-revflag"</codeph>, process contents,
          <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:53;97:19">"end-revflag"</codeph>/<codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:54;97:50">"end-flagit"</codeph>, end tag - you just need to delete the calls to
        these templates. Flags will be generated simply by processing the element contents in document order.</p>
      <p class="- topic/p " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="p:14;99:10">If the flow of your element rule processes flags outside of the normal document-order. There are generally two
        reasons this is done. The first case is for elements like <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:55;100:75">&lt;ol&gt;</codeph>, where flags must appear
        before the <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:56;101:28">&lt;ol&gt;</codeph> in order to create valid XHTML. The second is for elements like
          <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:57;102:19">&lt;section&gt;</codeph>, where start flags are created, followed by the title or some generated text,
        element contents, and finally end flags. In either of these cases, support for processing flags in document
        order is disabled, so they must be explicitly processed out-of-line. This is done with the following two lines
        (one for start flag/revision, one for end
        flag/revision):<codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeblock:2;106:35">Create starting flag and revision images:
&lt;xsl:apply-templates select="*[contains(@class,' ditaot-d/ditaval-startprop ')]" mode="out-of-line"/&gt;

Create ending flag and revision images:
&lt;xsl:apply-templates select="*[contains(@class,' ditaot-d/ditaval-endprop ')]" mode="out-of-line"/&gt;</codeblock></p>
      <p class="- topic/p " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="p:15;111:10">For example, the following lines are used in DITA-OT 1.7 to process the <xmlelement class="+ topic/keyword markup-d/markupname xml-d/xmlelement " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="xmlelement:1;111:94">ul</xmlelement> element
        (replacing the 29 lines used in DITA-OT
        1.6):<codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeblock:3;113:25">&lt;xsl:template match="*[contains(@class,' topic/ul ')]"&gt;
  <b class="+ topic/ph hi-d/b " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="b:1;114:6">&lt;xsl:apply-templates select="*[contains(@class,' ditaot-d/ditaval-startprop ')]" mode="out-of-line"/&gt;</b>
  &lt;xsl:call-template name="setaname"/&gt;
  &lt;ul&gt;
    &lt;xsl:call-template name="commonattributes"/&gt;
    &lt;xsl:apply-templates select="@compact"/&gt;
    &lt;xsl:call-template name="setid"/&gt;
    &lt;xsl:apply-templates/&gt;
  &lt;/ul&gt;
  <b class="+ topic/ph hi-d/b " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="b:2;122:6">&lt;xsl:apply-templates select="*[contains(@class,' ditaot-d/ditaval-endprop ')]" mode="out-of-line"/&gt;</b>
  &lt;xsl:value-of select="$newline"/&gt;
&lt;/xsl:template&gt;</codeblock></p></section>
    <section class="- topic/section " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="section:6;125:14">
      <title class="- topic/title " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="title:7;126:14">Migrating <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:58;126:32">"start-flags-and-rev"</codeph> and <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:59;126:75">"end-flags-and-rev"</codeph></title>
      <ul class="- topic/ul " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="ul:3;127:11">
        <li class="- topic/li " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="li:14;128:13"><codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:60;128:21">"start-flags-and-rev"</codeph> is equivalent to calling <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:61;128:85">"start-flagit"</codeph> followed by
            <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:62;129:21">"start-revflag"</codeph>; it should be migrated as in the previous section.</li>
        <li class="- topic/li " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="li:15;130:13"><codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:63;130:21">"end-flags-and-rev"</codeph> is equivalent to calling <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:64;130:83">"end-revflag"</codeph> followed by
            <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:65;131:21">"end-flagit"</codeph>; it should be migrated as in the previous section.</li>
      </ul></section>
    <section class="- topic/section " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="section:7;133:14">
      <title class="- topic/title " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="title:8;134:14">Migrating <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:66;134:32">"revblock"</codeph> and <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:67;134:64">"revtext"</codeph></title>
      <p class="- topic/p " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="p:16;135:10">Calls to these two templates can be replaced with a simple call to
        <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:68;136:17">&lt;xsl:apply-templates/&gt;</codeph>.</p></section>
    <section class="- topic/section " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="section:8;137:14">
      <title class="- topic/title " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="title:9;138:14">Migrating modes <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:69;138:38">"outputContentsWithFlags"</codeph> and
          <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:70;139:19">"outputContentsWithFlagsAndStyle"</codeph></title>
      <p class="- topic/p " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="p:17;140:10">Processing an element with either of these modes can be replaced with a simple call to
          <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:71;141:19">&lt;xsl:apply-templates/&gt;</codeph>.</p></section>
    <section class="- topic/section " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="section:9;142:14">
      <title class="- topic/title " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="title:10;143:14">Migrating <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:72;143:32">mode="elementname-fmt"</codeph></title>
      <p class="- topic/p " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="p:18;144:10">Prior to DITA-OT 1.7, many elements were processed with the following
        logic:<pre xml:space="preserve" class="- topic/pre " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="pre:1;145:20">Match element
    Set variable to determine if revisions are active and $DRAFT is on
    If active
        create division with rev style
            process element with mode="elementname-fmt"
        end division
    Else
        process element with mode="elementname-fmt"

Match element with mode="elementname-fmt"
    Process as needed</pre></p>
      <p class="- topic/p " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="p:19;156:10">Beginning with DITA-OT 1.7, styling from revisions is handled automatically with the
          <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:73;157:19">"commonattributes"</codeph> template. This means there is no need for the extra testing, or the
        indirection to <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:74;158:32">mode="elementname-fmt"</codeph>. These templates are deprecated, and element processing
        will move into the main element rule. Overrides that include this indirection may remove it; overrides should
        also be sure to match the default rule, rather than matching with
      <codeph class="+ topic/ph pr-d/codeph " xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/flagging-migration.dita" xtrc="codeph:75;161:15">mode="elementname-fmt"</codeph>.</p></section>
  </refbody>
<related-links class="- topic/related-links "><linkpool class="- topic/linkpool " xtrc="topicref:8;14:87" xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/migration.ditamap"><link class="- topic/link " format="dita" href="../dev_ref/migrating-to-1.7.dita" mapclass="- map/topicref " role="parent" scope="local" type="reference" xtrc="topicref:7;13:62" xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/migration.ditamap"><?ditaot usertext?><linktext class="- topic/linktext "><?ditaot gentext?>Migrating to release 1.7</linktext><?ditaot genshortdesc?><desc class="- topic/desc ">In DITA-OT 1.7, a new preprocessing step implements flagging for HTML-based output formats. PDF processing     was corrected with regard to <codeph class="+ topic/ph pr-d/codeph " xtrc="codeph:1;10:42" xtrf="file:/Users/ekimber/workspace-ditaot/dita-ot-2.x/src/main/docsrc/dev_ref/migrating-to-1.7.dita">shortdesc</codeph> handling, and a new XSLT template mode was introduced for     HTML TOC processing. Several stylesheets were moved to plug-in specific folders and deprecated properties and XSLT     variables were removed. </desc></link></linkpool></related-links></reference>